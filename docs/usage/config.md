# Configuration

Precedence rules:

1. CLI Switches
2. Env Vars
3. TOML file

## Toml based

pyproject.toml example
```toml
[tool.bash2gitlab]
input_file = "my_ci.yml"
scripts_out = "decompileded_scripts/"
dry_run = false
```

bash2gitlab.toml example
```toml
input_dir = "/path/from/toml"
output_dir = "output/toml"
verbose = false
```

## Environment Variable Based

Prefix any switch with BASH2GITLAB
```bash
export BASH2GITLAB_OUTPUT_FILE=out.yml
export BASH2GITLAB_QUIET=1
```

## Full Example

```toml
# This file demonstrates all available configuration options for bash2gitlab.
# You can place this in your project root, or configure it within pyproject.toml
# under the tool.bash2gitlab section.

[tool.bash2gitlab]
# --- General Settings ---
# These settings apply to all commands unless overridden in a command-specific section.
# They can also be set via environment variables (e.g., BASH2GITLAB_INPUT_DIR).

# The root directory for your uncompiled source files (.yml, .sh, etc.).
input_dir = "ci/src"

# The directory where compiled GitLab CI files will be written.
output_dir = "ci/dist"

# Default number of parallel processes to use for commands like 'compile' and 'lint'.
# Can be overridden per command.
parallelism = 4

# If true, commands will simulate changes without writing to the filesystem.
dry_run = false

# If true, enables verbose (DEBUG level) logging output.
verbose = false

# If true, suppresses all logging output except for critical errors.
quiet = false

# A custom header to prepend to all files generated by the 'compile' command.
# If commented out, a default header will be used.
custom_header = """#
# This file is auto-generated by the Awesome Corp CI pipeline.
# Source of truth is in the 'ci/src' directory.
# Last compiled on: 2025-08-16
#
"""

# --- Custom Shebangs ---
# The `[shebangs]` table allows you to define custom shebang lines for
# script files generated by the 'shred' command, based on their file extension.
[shebangs]
sh = "#!/usr/bin/env bash"
py = "#!/usr/bin/env python3"
ps1 = "# PowerShell script"
js = "#!/usr/bin/env node"


# --- Command-Specific Settings ---
# These sections allow you to override the general settings for a specific command.

[compile]
# Overrides for the 'compile' command.
# You could, for example, have a different output directory just for compiling.
# output_dir = "ci/compiled"
watch = false # Default for --watch flag

[shred]
# Overrides for the 'shred' command.
# For example, you can set default input and output paths.
input_file = "ci/dist/.gitlab-ci.yml"
# input_folder = "ci/dist/"
output_dir = "ci/shredded"

[lint]
# Overrides for the 'lint' command. This is very useful for defining
# your GitLab instance details once.
output_dir = "ci/dist" # Directory containing compiled YAML to lint.
gitlab_url = "https://gitlab.com"
# token = "your_gitlab_private_token" # Can be set via env var BASH2GITLAB_LINT_TOKEN
project_id = 12345678
ref = "main"
include_merged_yaml = false
timeout = 30.0 # 30-second timeout for API requests

[copy2local]
# Default settings for the 'copy2local' command.
repo_url = "git@gitlab.com:your-group/your-project.git"
branch = "main"
source_dir = "ci/src"
copy_dir = "local-test-project/ci"

[map]
# Default settings for 'map-deploy' and 'commit-map' commands.
pyproject_path = "pyproject.toml"
force = false
```